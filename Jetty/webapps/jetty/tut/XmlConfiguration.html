<BR><H1>XML Configuration Tutorial
&nbsp;&nbsp;&nbsp;&nbsp;<FONT size=-2>
<A href="Server.html">Back</A>
<A href="index.html">Index</A>
<A href="..">Exit</A>
<A href="logging.html">Next</A>
</FONT></H1>


The 
<a href="/javadoc/org/mortbay/xml/XmlConfiguration.html">org.mortbay.xml.XmlConfiguration</a> 
class provides an XML format for calling java APIs on objects. The XML format is described in
the <A href="/configure_1_1.dtd">configure_1_1 DTD</A>. XmlConfiguration files must be of the 
following format:
<PRE>
    &lt;?xml version="1.0"  encoding="ISO-8859-1"?&gt;
    &lt;!DOCTYPE Configure PUBLIC 
        "-//Mort Bay Consulting//DTD Configure 1.1//EN" 
        "http://jetty.mortbay.org/configure_1_1.dtd"&gt;

    &lt;Configure class="packagename.classname"&gt; &lt;!-- class specified here--&gt;
       &lt;!-- Configure clauses here --&gt;
    &lt;/Configure&gt;
</PRE>
The following examples will leave out the XML headers for clarity.
<P>
The XML file is applied to an object, which must an instance of the class named in the
<Code>Configure</Code> element. For Jetty configuration, the file is applied to an
instance of org.mortbay.jetty.Server (or org.mortbay.jetty.servlet.WebApplicationContext for
web-jetty.xml).


<P>
<FONT Size=+1><B>Set Element</B></FONT><BR>
An attribute set method may be called on the configure object with a <Code>Set</Code> elements. The <Code>name</Code>element attribute identifies the object attribute to be set.  The content of the element is used as the value to set:
<PRE>
    &lt;Set name="attrName"&gt;value&lt;/Set&gt;
</PRE>
This is equivalent to the java code <Code>object.setAttrName(value);</Code>.
A best effort attempt is made to convert the string value to the required type of the Set. Alternately
a a type attribute may be specified
<PRE>
    &lt;Set name="doubleAttrName" type="double"&gt;1.2&lt;/Set&gt;
</PRE>
Types understood are: String, Character, Short, Byte, Integer, Long, Boolean, Float, Double, char, short, byte, int, long, boolean, float, double, URL, InetAddress and InetAddrPort. For types other
than these, a <Code>New</Code> element should be used (see below).

<P>
<FONT Size=+1><B>Call Element</B></FONT><BR>
A call to an arbitrary method of the config object can be made with a <Code>Call</Code> element.
The <Code>name</Code> element attribute identifies the method and the content of the element can be zero or more <Code>Arg</Code> elements that provide the arguements to the call:
<PRE>
    &lt;Call name="methodName"&gt;
      &lt;Arg type="int"&gt;1&lt;/Arg&gt;
      &lt;Arg type="String"&gt;value2&lt;/Arg&gt;
    &lt;/Call&gt;
</PRE>
This is equivalent to the java code <Code>object.methodName(Integer.parseInt("1"),"value2");</Code>. The values of the <Code>Arg</Code> elements are treated as a String if no type is specified. Arbitrary 
argument types can be passed using a <Code>New</Code> element as the argument value.
<P>
If the method call returns an object, it becomes the configuration object within the bounds of the
<Code>Call</Code> element. After the last argument element <Code>Set</Code>, <Code>Call</Code> and
<Code>Put</Code> elements can be included to act on the returned object:
<PRE>
    &lt;Call name="methodName"&gt;
      &lt;Arg&gt;value&lt;/Arg&gt;
      &lt;Set name="attr"&gt;value&lt;/Set&gt;
      &lt;Call name="method"/&gt;
    &lt;/Call&gt;
</PRE>
This is equivalent to the java code:
<PRE>
   Object tmp = object.methodName("value");
   tmp.setAttr("value");
   tmp.method();
</PRE>
The <Code>Call</Code> elements may be nested to an arbitrary depth:
<PRE>
    &lt;Call name="method1"&gt;
      &lt;Call name="method2"&gt;
        &lt;Call name="method3"&gt;
        &lt;/Call&gt;
      &lt;/Call&gt;
    &lt;/Call&gt;
</PRE>
Which is equivalent to the java code <Code>object.method1().method2().method3()</Code>.
<P>
If a <Code>Call</Code> element has both a name and class attribute, it is treated as a call to 
a static method.
<P>
<FONT Size=+1><B>New Element</B></FONT><BR>
Values for <Code>Set</Code> and <Code>Arg</Code> elements may be supplied by a nested 
<Code>New</Code> element:
<PRE>
    &lt;Call name="methodName"&gt;
      &lt;Arg&gt;&lt;New class"MyClass1"/&gt;&lt;/Arg&gt;
      &lt;Set name="attr"&gt;&lt;New class="MyClass2"/&gt;&lt;/Set&gt;
    &lt;/Call&gt;
</PRE>
Which is equivalent to the java code 
<Code>object.methodName(new MyClass1()).setAttr(new MyClass2())</Code>.  
The <Code>New</Code> element may itself contain <Code>Arg</Code> elements to be
passed to the new call and <Code>Set</Code>, <Code>Call</Code> and
<Code>Put</Code> elements which act on the newly created object:
<PRE>
    &lt;Set name="attr1"&gt;
      &lt;New class="MyClass1"&gt;
        &lt;Arg&gt;value&lt;/Arg&gt;
        &lt;Set name="attr2"&gt;&lt;New class="MyClass2"/&gt;&lt;/Set&gt;
      &lt;/New&gt;
    &lt;/Set&gt;
</PRE>
Which is equivalent to the java code:
<PRE>
    Object tmp=new MyClass1("value");
    tmp.setAttr2(new MyClass2());
    object.setAttr1(tmp);
</PRE>
<P>
<FONT Size=+1><B>Put Element</B></FONT><BR>
A call to a method witht the signature <Code>Object put(Object name, Object value)</Code> 
can be called with the <Code>Put</Code> element:
<PRE>
    &lt;Put name="name"&gt;value&lt;/Put&gt;
</PRE>
Which is equivalent to the java code <Code>object.put("name","value");</Code>.

<P>
<FONT Size=+1><B>SystemProperty Element</B></FONT><BR>
Java System Properties can be looked up and used as values in <Code>Set</Code>, <Code>Arg</Code> and
<Code>Put</Code> elements.  This can be used to parameterize config files:
<PRE>
    &lt;Set name="resourceBase"&gt;
      &lt;SystemProperty name="jetty.home" default="."/&gt;/docroot/
    &lt;/Set&gt;
</PRE>
<P>
<FONT size=-1>
<A href="Server.html">Back</A>
<A href="index.html">Index</A>
<A href="..">Exit</A>
<A href="logging.html">Next</A>
</FONT>
<P>